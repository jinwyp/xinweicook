<div class="address-component" ng-class="{cur: css.cur, edit: css.edit}"
    ng-click="choose($event)">

    <div class="address-block" ng-if="oldAddress">
        <span class="deliverable-tag" ng-if="addr.isAvailableForEat">便当可送达</span>
        <div>{{addr.contactPerson}}</div>
        <div class="cur-show">{{addr.mobile | beautifyMobile}}</div>
        <div class="cur-show">{{addr.province + ' ' + addr.city + ' ' + addr.district}}</div>
        <div>{{addr.street}}</div>
        <div class="cur-show">{{addr.address}}</div>
        <div class="user-actions">
            <span class="glyphicon glyphicon-pencil"></span>
            <span ng-click="deleteAddress($event)" class="glyphicon glyphicon-trash"></span>
        </div>
    </div>

    <div class="new-address-block" ng-if="!oldAddress">
        + 新建收货地址
    </div>


    <form ng-if="css.edit" name="form">
        <div ng-init="initForm(form, addr)" ng-class="{'with-tag': addr.isAvailableForEat}">
            <input name="contactPerson" type="text" placeholder="收货人"
                   ng-model="addr.contactPerson" auto-focus
                   minlength="2" required/>
            <span class="err-tip" ng-if="form.contactPerson.$error.required">必填</span>
            <span class="err-tip" ng-if="form.contactPerson.$error.minlength">联系人姓名至少2个字</span>
        </div>
        <div>
            <input name="mobile" type="tel" placeholder="手机号"
                   ng-model="addr.mobile"
                   minlength="11" maxlength="11" required/>
            <span class="err-tip" ng-if="form.mobile.$error.required">必填</span>
                    <span class="err-tip"
                          ng-if="form.mobile.$error.maxlength || form.mobile.$error.minlength">手机号码长度为11位</span>
        </div>

        <div ng-if="!css.showFakeInput" class="selects">
            <div class="select">
                <select required name="province" id="province"
                        ng-options="province for province in options()"
                        ng-model="addr.province"></select>
            </div>

            <div class="select">
                <select required name="city" id="city"
                        ng-options="city for city in options(addr.province)"
                        ng-model="addr.city"></select>
            </div>

            <div class="select">
                <select required name="district" id="district"
                        ng-options="district for district in options(addr.province, addr.city)"
                        ng-model="addr.district"></select>
            </div>

        </div>
        <div ng-if="css.showFakeInput">
            <input type="text" placeholder="省、市、区"  ng-click="css.showFakeInput = false"/>
        </div>

        <div ng-click="showSearchAddress()">
            {{addr.street}}
            <input type="hidden" name="street" ng-model="addr.street" required/>
            <span class="tip" ng-if="form.street.$error.required">必填</span>
        </div>
        <div>
            <input name="address" type="text" placeholder="楼层、门牌号" required ng-model="addr.address">
            <span class="err-tip" ng-if="form.address.$error.required">必填</span>
        </div>
    </form>

    <div class="search-address-main" ng-if="css.edit && css.showSearchAddress">
        <form id="address-form">
            <!--<span ng-click="data.street && confirmStreet()" ng-class="{invalid: !data.street}" class="confirm">确定</span>-->
            <div><input type="text" placeholder="小区、写字楼、地标名称" id="address"
                        ng-model="data.street"
                        ng-model-options="{debounce: 400}"
                        ng-change="searchAddress()"/></div>
        </form>

        <div class="find-address-tip" ng-if="data.streetList.length">您要找的是不是?</div>

        <div class="no-address-tip" ng-if="data.street && !data.streetList.length">
            <h4>未能找到此地址</h4>
            <p>建议只输入小区、写字楼、地标名称等</p>
        </div>

        <ul class="results">
            <li ng-click="confirmStreet(street)" ng-repeat="street in data.streetList">
                <h4>{{street.name}}</h4>
                <p>{{street.address}}</p>
            </li>
        </ul>
    </div>
</div>