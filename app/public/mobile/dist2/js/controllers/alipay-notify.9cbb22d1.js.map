{"version":3,"names":[],"mappings":"","sources":["alipay-notify.js"],"sourcesContent":["angular.module('xw.controllers').controller('alipayNotifyCtrl', function ($scope, Alipay, Debug, Orders, $localStorage) {\n\n    init();\n\n    function init() {\n        var searches = location.search.slice(1).split('&');\n        $scope.searches = searches.reduce(function (obj, cur) {\n            cur = cur.split('=');\n            obj[cur[0]] = decodeURIComponent(cur[1]);\n            return obj\n        }, {});\n\n        Debug.alert($scope.searches);\n\n        if ($scope.searches.trade_status == 'TRADE_FINISHED' ||\n            $scope.searches.trade_status == 'TRADE_SUCCESS'\n        ) {\n            $scope.success = true;\n            var orderId = $scope.searches['out_trade_no'];\n\n\n            if (!$localStorage.alipayOrder) {\n                //充值\n                setTimeout(function () {\n                    location.href = '/mobile/balance';\n                }, 2500);\n            } else {\n                delete $localStorage.alipayOrder;\n                Orders.updateOrder(orderId, {isPaymentPaid: 'true'}).then(function () {\n                    Debug.alert('更新订单状态成功');\n                    setTimeout(function () {\n                        location.href = '/mobile/invite'\n                    }, 2000);\n                }).catch(function (res) {\n                    alert('更新订单状态失败');\n                    Debug.alert('订单状态更新失败');\n                    Debug.alert(res);\n                });\n            }\n        }\n    }\n});"],"file":"js/controllers/alipay-notify.9cbb22d1.js","sourceRoot":"/source/"}