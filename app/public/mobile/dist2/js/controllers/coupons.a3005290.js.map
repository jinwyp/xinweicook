{"version":3,"names":[],"mappings":"","sources":["coupons.js"],"sourcesContent":["angular.module('xw.controllers').controller('couponsCtrl', function ($scope, User, Debug, ScopeDecorator, Alert) {\n\n    ScopeDecorator.common($scope);\n\n    $scope.apply = function () {\n        if ($scope.invitationCode == $scope.user.invitationSendCode) {\n            // todo: to be deleted\n            alert('亲,这是您自己的邀请码, 是给您的好友兑换的, 自己不能兑换哦. \\n当您的好友使用此兑换码兑换了优惠券,并成功通过它购买后,你就可以获得优惠券');\n            return;\n        }\n        User.applyInvitationCode($scope.invitationCode).then(function () {\n            alert('兑换成功!');\n            $scope.invitationCode = '';\n            User.getUserInfo().then(function (res) {\n                $scope.couponList = res.data.couponList;\n            });\n        }).catch(function (res) {\n            Alert.show(res.data.validationStatus, '兑换失败, 请稍后再试');\n        })\n    };\n\n    function init() {\n        User.getUserInfo().then(function (res) {\n            $scope.user = res.data;\n            $scope.couponList = res.data.couponList;\n        });\n\n        var invitationCode = location.search.substring(1).split('=');\n        if (invitationCode.length > 1) {\n            invitationCode = invitationCode[1];\n            if (/^\\w{8}$/.test(invitationCode)) {\n                $scope.invitationCode = invitationCode;\n            }\n        }\n    }\n\n    init();\n});"],"file":"js/controllers/coupons.a3005290.js","sourceRoot":"/source/"}