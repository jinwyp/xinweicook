<div class="col-lg-12">

    <div class="panel panel-info">
        <div class="panel-heading">
            <h3 class="panel-title panel-titlenew"><span ng-show="css.isAddNewStatus">新增 Order 订单</span> <span ng-hide="css.isAddNewStatus">修改 Order 订单 - {{data.order.orderNumber}} - {{data.order._id}}</span>
                <a class="btn btn-sm btn-info pull-right" ui-sref="menu.orders" role="button">返回</a>
            </h3>
        </div>


        <div class="panel-body">

            <table class="table table-striped table-bordered table-hover table-responsive">
                <thead>
                <tr>
                    <th>菜ID</th>
                    <th>菜名</th>
                    <th>类型</th>
                    <th>主菜配菜</th>
                    <th>价格</th>
                    <th>数量</th>
                    <th>菜品总价</th>
                </tr>
                </thead>
                <tbody>
                <tr ng-repeat="dish in data.order.dishHistory ">
                    <td>{{dish.dish._id}}</td>
                    <td>{{dish.dish.title.zh}}</td>
                    <td>{{dish.dish.cookingType}}</td>
                    <td>{{dish.dish.sideDishType}}</td>

                    <td>{{dish.dish.priceOriginal}}</td>
                    <td>{{dish.number}}</td>
                    <td>{{dish.dish.priceOriginal * dish.number}}</td>
                </tr>
                </tbody>
            </table>

        </div>


        <div class="panel-body">
            <form class="form-horizontal" name="orderForm" role="form" novalidate ng-cloak>

                <div class="form-group has-feedback" >
                    <label class="col-lg-2 control-label" >订单号:</label>

                    <div class="col-lg-10">
                        <span class="help-block">{{data.order.orderNumber}}</span>
                    </div>
                </div>

                <div class="form-group has-feedback" >
                    <label class="col-lg-2 control-label" >是否被拆单:</label>

                    <div class="col-lg-2">
                        <span class="help-block">{{data.order.isSplitOrder}}</span>
                    </div>

                    <label class="col-lg-2 control-label" >是否为子订单:</label>

                    <div class="col-lg-2">
                        <span class="help-block">{{data.order.isChildOrder}}</span>
                    </div>
                </div>

                <div class="form-group has-feedback" >
                    <label class="col-lg-2 control-label" >子订单列表:</label>

                    <div class="col-lg-10">
                        <span class="help-block" ng-repeat="childOrder in data.order.childOrderList">{{childOrder}}</span>
                    </div>
                </div>

                <div class="form-group has-feedback" >
                    <label class="col-lg-2 control-label" >订单来源:</label>

                    <div class="col-lg-10">
                        <span class="help-block">{{data.order.clientFrom}}</span>
                    </div>
                </div>

                <div class="form-group has-feedback" >
                    <label class="col-lg-2 control-label" >收货地址:</label>

                    <div class="col-lg-10">
                        <span class="help-block" ng-repeat="(key, value) in data.order.address">{{key}}:{{value}}</span>
                    </div>
                </div>



                <div class="form-group has-feedback" >
                    <label class="col-lg-2 control-label" >支付状态:</label>

                    <div class="col-lg-2">
                        <span class="help-block">{{data.order.payment}}</span>
                    </div>
                    <div class="col-lg-2">
                        <span class="help-block" ng-show="data.order.isPaymentPaid">已完成在线支付</span>
                        <span class="help-block" ng-hide="data.order.isPaymentPaid">未完成在线支付</span>
                    </div>
                    <div class="col-lg-2" ng-if="data.order.payment=='cod'">
                        <span class="help-block" ng-show="data.order.paymentUsedCash">货到付款 现金</span>
                        <span class="help-block" ng-hide="data.order.paymentUsedCash">货到付款 刷卡</span>
                    </div>
                </div>


                <div class="form-group has-feedback" >
                    <label class="col-lg-2 control-label" >总价格:</label>

                    <div class="col-lg-2">
                        <span class="help-block" >{{data.order.totalPrice}}</span>
                    </div>

                    <div class="col-lg-8">
                        <span class="help-block" >菜品价格:{{data.order.dishesPrice}} + 运费:{{data.order.freight}} - 优惠码:{{data.order.promotionCode}}</span>
                    </div>
                </div>


                <div class="form-group has-feedback" >
                    <label class="col-lg-2 control-label" >配送物流:</label>

                    <div class="col-lg-10">
                        <span class="help-block" ng-repeat="(key, value) in data.order.express">{{key}}:{{value}}</span>
                    </div>
                </div>


                <div class="form-group has-feedback" >
                    <label class="col-lg-2 control-label" >预计送货时间:</label>

                    <div class="col-lg-10">
                        <span class="help-block" >{{data.order.deliveryDateTime | date:'yyyy-MM-dd HH:mm:ss Z'}}</span>
                    </div>
                </div>

                <div class="form-group has-feedback" >
                    <label class="col-lg-2 control-label" >用户留言:</label>

                    <div class="col-lg-10">
                        <span class="help-block" >{{data.order.userComment}}</span>
                    </div>
                </div>

                <div class="form-group has-feedback" >
                    <label class="col-lg-2 control-label" >客服留言:</label>

                    <div class="col-lg-10">
                        <span class="help-block" >{{data.order.csComment}}</span>
                    </div>
                </div>





                <div class="form-group has-feedback" ng-class="{'has-success':orderForm.orderStatus.$dirty&&orderForm.orderStatus.$valid, 'has-error':orderForm.orderStatus.$dirty&&orderForm.orderStatus.$invalid}">
                    <label class="col-lg-2 control-label" >订单状态:</label>

                    <div class="col-lg-5">
                        <select class="form-control" name="orderStatus" ng-model="data.order.status" ng-options="status.value as status.name for status in data.orderStatusList">
                        </select>
                    </div>
                </div>



                <div class="form-group">
                    <div class="col-lg-offset-2 col-lg-1">
                        <button type="submit" class="btn btn-primary" ng-show="css.isAddNewStatus" ng-disabled="orderForm.$invalid" ng-click="addNewTag(orderForm)">Save</button>
                        <button type="submit" class="btn btn-primary" ng-hide="css.isAddNewStatus" ng-disabled="orderForm.$invalid" ng-click="updateOrder(orderForm)">Save</button>
                    </div>
                </div>
            </form>

        </div>
    </div>


</div>