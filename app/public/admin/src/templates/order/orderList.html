
<div class="col-lg-12">

    <div class="panel panel-info">
        <div class="panel-heading">
            <h3 class="panel-title panel-titlenew">Order 订单列表</h3>
        </div>

        <div class="panel-body">
            <form class="form-horizontal" name="searchForm" novalidate ng-cloak>
                <div class="form-group has-feedback" ng-class="{'has-success':searchForm.keyword.$dirty&&searchForm.keyword.$valid, 'has-error':searchForm.keyword.$dirty&&searchForm.keyword.$invalid}">
                    <label for="inputKeyword" class="col-lg-2 control-label" >关键字实时筛选</label>
                    <div class="col-lg-4">
                        <input type="text" class="form-control" id="inputKeyword" placeholder="keyword" name="keyword" ng-model="data.searchFilter" required ng-minlength="2">
                        <span class="glyphicon glyphicon-ok form-control-feedback" aria-hidden="true" ng-if="searchForm.keyword.$dirty&&searchForm.keyword.$valid"></span>
                        <span class="glyphicon glyphicon-remove form-control-feedback" aria-hidden="true" ng-if="searchForm.keyword.$dirty&&searchForm.keyword.$invalid"></span>
                    </div>
                    <div class="col-lg-6">
                        <span class="form-validation help-block" ng-if="searchForm.keyword.$dirty&&searchForm.keyword.$error.required">请填入信息！</span>
                        <span class="form-validation help-block" ng-if="searchForm.keyword.$dirty&&searchForm.keyword.$error.minlength || searchForm.keyword.$dirty&&searchForm.keyword.$error.maxlength">输入的信息长度错误！</span>
                    </div>
                </div>

                <div class="form-group has-feedback" ng-class="{'has-success':searchForm.cookingType.$dirty&&searchForm.cookingType.$valid, 'has-error':searchForm.cookingType.$dirty&&searchForm.cookingType.$invalid}">
                    <label for="inputCookingType" class="col-lg-2 control-label" >订单菜品类型</label>
                    <div class="col-lg-8">
                        <label class="radio-inline" ng-repeat="cookingType in data.dishCookingTypeList">
                            <input type="radio" name="cookingType" id="inputCookingType" ng-value="cookingType.value" ng-model="data.searchOptions.cookingType">{{cookingType.name}}
                        </label>
                    </div>
                </div>

                <div class="form-group has-feedback" ng-class="{'has-success':searchForm.clientFromType.$dirty&&searchForm.clientFromType.$valid, 'has-error':searchForm.clientFromType.$dirty&&searchForm.clientFromType.$invalid}">
                    <label for="inputClientFromType" class="col-lg-2 control-label" >订单来源类型</label>
                    <div class="col-lg-8">
                        <label class="radio-inline" ng-repeat="clientFromType in data.clientFromTypeList">
                            <input type="radio" name="clientFromType" id="inputClientFromType" ng-value="clientFromType.value" ng-model="data.searchOptions.clientFrom">{{clientFromType.name}}
                        </label>
                    </div>
                </div>

                <div class="form-group has-feedback" ng-class="{'has-success':searchForm.orderStatus.$dirty&&searchForm.orderStatus.$valid, 'has-error':searchForm.orderStatus.$dirty&&searchForm.orderStatus.$invalid}">
                    <label for="inputOrderStatus" class="col-lg-2 control-label" >订单状态</label>
                    <div class="col-lg-8">
                        <label class="radio-inline" ng-repeat="status in data.orderStatusList">
                            <input type="radio" name="orderStatus" id="inputOrderStatus" ng-value="status.value" ng-model="data.searchOptions.status">{{status.name}}
                        </label>
                    </div>
                </div>

                <div class="form-group has-feedback" ng-class="{'has-success':searchForm.clientFromType.$dirty&&searchForm.clientFromType.$valid, 'has-error':searchForm.clientFromType.$dirty&&searchForm.clientFromType.$invalid}">
                    <label for="inputDeliveryDateType" class="col-lg-2 control-label" >配送时间类型</label>
                    <div class="col-lg-8">
                        <label class="radio-inline" ng-repeat="deliveryDateType in data.deliveryDateTypeList">
                            <input type="radio" name="deliveryDateType" id="inputDeliveryDateType" ng-value="deliveryDateType.value" ng-model="data.searchOptions.deliveryDateType">{{deliveryDateType.name}}
                        </label>
                    </div>
                </div>


                <div class="form-group has-feedback" ng-class="{'has-success':searchForm.isSplitOrder.$dirty&&searchForm.isSplitOrder.$valid, 'has-error':searchForm.isSplitOrder.$dirty&&searchForm.isSplitOrder.$invalid}">
                    <label for="inputIsSplitOrder" class="col-lg-2 control-label" >是否拆单</label>
                    <div class="col-lg-8">
                        <label class="radio-inline" ng-repeat="status in data.isSplitOrderList">
                            <input type="radio" name="isSplitOrder" id="inputIsSplitOrder" ng-value="status.value" ng-model="data.searchOptions.isSplitOrder">{{status.name}}
                        </label>
                    </div>
                </div>

                <div class="form-group has-feedback" ng-class="{'has-success':searchForm.isChildOrder.$dirty&&searchForm.isChildOrder.$valid, 'has-error':searchForm.isChildOrder.$dirty&&searchForm.isChildOrder.$invalid}">
                    <label for="inputIsChildOrder" class="col-lg-2 control-label" >是否为子订单</label>
                    <div class="col-lg-8">
                        <label class="radio-inline" ng-repeat="status in data.isChildOrderList">
                            <input type="radio" name="isChildOrder" id="inputIsChildOrder" ng-value="status.value" ng-model="data.searchOptions.isChildOrder">{{status.name}}
                        </label>
                    </div>
                </div>


                <div class="form-group has-feedback">
                    <label class="col-lg-2 control-label" >日期范围起始</label>
                    <div class="col-lg-4">
                        <div class="input-group">
                            <input type="text" class="form-control" datepicker-popup="yyyy-MM-dd" ng-model="data.searchDateFrom" is-open="data.datePickerIsOpen" min-date="'2015-01-01'" max-date="'2050-01-30'"  />
                            <span class="input-group-btn">
                                <button type="button" class="btn btn-default" ng-click="datePickerOpen()"><i class="glyphicon glyphicon-calendar"></i></button>
                            </span>
                        </div>
                    </div>
                </div>


                <div class="form-group has-feedback" ng-class="{'has-success':searchForm.userId.$dirty&&searchForm.userId.$valid, 'has-error':searchForm.userId.$dirty&&searchForm.userId.$invalid}">
                    <label for="inputUserId" class="col-lg-2 control-label" >订单所属用户_ID</label>
                    <div class="col-lg-4">
                        <input type="text" class="form-control" id="inputUserId" placeholder="用户_ID" name="userId" ng-model="data.searchOptions.user" ng-minlength="23">
                        <span class="glyphicon glyphicon-ok form-control-feedback" aria-hidden="true" ng-if="searchForm.userId.$dirty&&searchForm.userId.$valid"></span>
                        <span class="glyphicon glyphicon-remove form-control-feedback" aria-hidden="true" ng-if="searchForm.userId.$dirty&&searchForm.userId.$invalid"></span>
                    </div>
                    <div class="col-lg-6">
                        <span class="form-validation help-block" ng-if="searchForm.userId.$dirty&&searchForm.userId.$error.required">请填入信息！</span>
                        <span class="form-validation help-block" ng-if="searchForm.userId.$dirty&&searchForm.userId.$error.minlength || searchForm.userId.$dirty&&searchForm.userId.$error.maxlength">输入的信息长度错误！</span>
                    </div>
                </div>

                <div class="form-group has-feedback" ng-class="{'has-success':searchForm.orderContactPerson.$dirty&&searchForm.orderContactPerson.$valid, 'has-error':searchForm.orderContactPerson.$dirty&&searchForm.orderContactPerson.$invalid}">
                    <label for="inputOrderContactPerson" class="col-lg-2 control-label" >该订单联系人</label>
                    <div class="col-lg-4">
                        <input type="text" class="form-control" id="inputOrderContactPerson" placeholder="联系人 (可能与该订单下单用户的信息不同)" name="orderContactPerson" ng-model="data.searchOptions.addressContactPerson" ng-minlength="2">
                        <span class="glyphicon glyphicon-ok form-control-feedback" aria-hidden="true" ng-if="searchForm.orderContactPerson.$dirty&&searchForm.orderContactPerson.$valid"></span>
                        <span class="glyphicon glyphicon-remove form-control-feedback" aria-hidden="true" ng-if="searchForm.orderContactPerson.$dirty&&searchForm.orderContactPerson.$invalid"></span>
                    </div>
                    <div class="col-lg-6">
                        <span class="form-validation help-block" ng-if="searchForm.orderContactPerson.$dirty&&searchForm.orderContactPerson.$error.required">请填入信息！</span>
                        <span class="form-validation help-block" ng-if="searchForm.orderContactPerson.$dirty&&searchForm.orderContactPerson.$error.minlength || searchForm.orderContactPerson.$dirty&&searchForm.orderContactPerson.$error.maxlength">输入的信息长度错误！</span>
                    </div>
                </div>

                <div class="form-group has-feedback" ng-class="{'has-success':searchForm.orderMobile.$dirty&&searchForm.orderMobile.$valid, 'has-error':searchForm.orderMobile.$dirty&&searchForm.orderMobile.$invalid}">
                    <label for="inputOrderMobile" class="col-lg-2 control-label" >该订单手机</label>
                    <div class="col-lg-4">
                        <input type="text" class="form-control" id="inputOrderMobile" placeholder="手机" name="orderMobile" ng-model="data.searchOptions.addressMobile" ng-minlength="2">
                        <span class="glyphicon glyphicon-ok form-control-feedback" aria-hidden="true" ng-if="searchForm.orderMobile.$dirty&&searchForm.orderMobile.$valid"></span>
                        <span class="glyphicon glyphicon-remove form-control-feedback" aria-hidden="true" ng-if="searchForm.orderMobile.$dirty&&searchForm.orderMobile.$invalid"></span>
                    </div>
                    <div class="col-lg-6">
                        <span class="form-validation help-block" ng-if="searchForm.orderMobile.$dirty&&searchForm.orderMobile.$error.required">请填入信息！</span>
                        <span class="form-validation help-block" ng-if="searchForm.orderMobile.$dirty&&searchForm.orderMobile.$error.minlength || searchForm.orderMobile.$dirty&&searchForm.orderMobile.$error.maxlength">输入的信息长度错误！</span>
                    </div>
                </div>


                <div class="form-group has-feedback" ng-class="{'has-success':searchForm.orderNumber.$dirty&&searchForm.orderNumber.$valid, 'has-error':searchForm.orderNumber.$dirty&&searchForm.orderNumber.$invalid}">
                    <label for="inputOrderNumber" class="col-lg-2 control-label" >订单号</label>
                    <div class="col-lg-4">
                        <input type="text" class="form-control" id="inputOrderNumber" placeholder="订单号" name="orderNumber" ng-model="data.searchOptions.orderNumber" ng-minlength="6">
                        <span class="glyphicon glyphicon-ok form-control-feedback" aria-hidden="true" ng-if="searchForm.orderNumber.$dirty&&searchForm.orderNumber.$valid"></span>
                        <span class="glyphicon glyphicon-remove form-control-feedback" aria-hidden="true" ng-if="searchForm.orderNumber.$dirty&&searchForm.orderNumber.$invalid"></span>
                    </div>
                    <div class="col-lg-6">
                        <span class="form-validation help-block" ng-if="searchForm.orderNumber.$dirty&&searchForm.orderNumber.$error.required">请填入信息！</span>
                        <span class="form-validation help-block" ng-if="searchForm.orderNumber.$dirty&&searchForm.orderNumber.$error.minlength || searchForm.orderNumber.$dirty&&searchForm.orderNumber.$error.maxlength">输入的信息长度错误！</span>
                    </div>
                </div>

                <div class="form-group has-feedback" ng-class="{'has-success':searchForm.orderId.$dirty&&searchForm.orderId.$valid, 'has-error':searchForm.orderId.$dirty&&searchForm.orderId.$invalid}">
                    <label for="inputOrderId" class="col-lg-2 control-label" >订单_ID</label>
                    <div class="col-lg-4">
                        <input type="text" class="form-control" id="inputOrderId" placeholder="订单ID" name="orderId" ng-model="data.searchOptions._id" ng-minlength="23">
                        <span class="glyphicon glyphicon-ok form-control-feedback" aria-hidden="true" ng-if="searchForm.orderId.$dirty&&searchForm.orderId.$valid"></span>
                        <span class="glyphicon glyphicon-remove form-control-feedback" aria-hidden="true" ng-if="searchForm.orderId.$dirty&&searchForm.orderId.$invalid"></span>
                    </div>
                    <div class="col-lg-6">
                        <span class="form-validation help-block" ng-if="searchForm.orderId.$dirty&&searchForm.orderId.$error.required">请填入信息！</span>
                        <span class="form-validation help-block" ng-if="searchForm.orderId.$dirty&&searchForm.orderId.$error.minlength || searchForm.orderId.$dirty&&searchForm.orderId.$error.maxlength">输入的信息长度错误！</span>
                    </div>
                </div>


                <div class="form-group has-feedback" ng-class="{'has-success':searchForm.isSort.$dirty&&searchForm.isSort.$valid, 'has-error':searchForm.isSort.$dirty&&searchForm.isSort.$invalid}">
                    <label  class="col-lg-2 control-label" >排序</label>
                    <div class="col-lg-8">
                        <label class="radio-inline" >
                            <input type="radio" name="isSort"  ng-value="'-createdAt'" ng-model="data.searchSort.sort">订单创建时间 从新到旧
                        </label>
                        <label class="radio-inline" >
                            <input type="radio" name="isSort"  ng-value="'-modifiedAt'" ng-model="data.searchSort.sort">支付时间 从新到旧
                        </label>
                        <label class="radio-inline" >
                            <input type="radio" name="isSort"  ng-value="'-deliveryDateTime'" ng-model="data.searchSort.sort">预计送达时间 从新到旧
                        </label>
                    </div>
                </div>


                <div class="form-group">
                    <div class="col-lg-offset-2 col-lg-10">
                        <button type="submit" class="btn btn-default" ng-click="searchOrderCount(searchForm)">搜索订单列表</button>
                        <button type="submit" class="btn btn-default" ng-click="searchOrderStatisticByAddress(searchForm)">手填地址</button>
                        <button type="submit" class="btn btn-default" ng-click="searchOrderStatisticByAddressAuto(searchForm)">自动地址</button>

                        <button type="submit" class="btn btn-default" ng-click="searchOrderStatisticByDailySales(searchForm, '-date')">日销量</button>
                        <button type="submit" class="btn btn-default" ng-click="searchOrderStatisticByHourSales(searchForm, '')">小时销量</button>



                        <a class="btn btn-default"  href="/api/administrator/export/ordersinternal?createdAt={{data.searchOptions.createdAt}}&status={{data.searchOptions.status}}&cookingType={{data.searchOptions.cookingType}}&clientFrom={{data.searchOptions.clientFrom}}&deliveryDateType={{data.searchOptions.deliveryDateType}}&idList={{arrayToUrl(data.exportOrderIdList)}}" target="_blank">导出选中内部制作单</a>
                        <a class="btn btn-default"  href="/api/administrator/shiplist/orders?idList={{arrayToUrl(data.exportOrderIdList)}}" target="_blank">导出选中出货单</a>
                        <a class="btn btn-default"  href="/api/administrator/export/orders" target="_blank">导出所有订单</a>
                    </div>

                </div>
            </form>

        </div>
    </div>

    <nav ng-if="css.showTable === 'orders'">
        <ul class="pagination" >
            <li>
                <span aria-hidden="true"> 共{{data.orderListCount}}条记录 </span>
            </li>

            <li>
                <a aria-label="Previous" ng-hide="data.orderListCurrentPage==1"  ng-click="changePagination(data.orderListCurrentPage - 1)"> <span aria-hidden="true">&laquo;</span></a>
            </li>
            <li ng-repeat="page in data.orderListPagesArray"><a ng-click="changePagination(page.value)">{{page.value}}</a></li>
            <li>
                <a aria-label="Next" ng-hide="data.orderListCurrentPage==data.orderListTotalPages"  ng-click="changePagination(data.orderListCurrentPage + 1)"><span aria-hidden="true">&raquo;</span> </a>
            </li>
        </ul>
    </nav>


    <table class="table table-striped table-bordered table-hover table-responsive" ng-if="css.showTable === 'orders'">
        <thead>
            <tr>
                <th>订单号 / 创建时间</th>
                <th>状态</th>
                <th>快递</th>
                <!--<th>拆分订单</th>暂时隐藏掉,S要求-->
                <!--<th>子订单</th>-->
                <th>来源</th>
                <th>联系人 / 手机</th>
                <th>地址</th>
                <th>用户备注</th>
                <th>客服备注</th>

                <th>支付方式</th>
                <th>是否付款</th>
                <!--<th>货到付款现金支付</th>-->
                <th>预计配送时间</th>
                <th>类型</th>
                <th>菜品价</th>
                <!--<th>积分</th>-->
                <th>优惠码/券 </th>
                <th>余额支付</th>
                <th>运费</th>
                <th>总价</th>

                <!--<th>操作</th>-->
            </tr>
        </thead>
        <tbody>
            <tr ng-repeat="order in data.orderList | filter: data.searchFilter">
                <td>
                    <a ui-sref="menu.updateOrder({ id: order._id })" style="font-size:18px;margin-right:.5em;">{{order.autoIncrementId.toString().substring(2)}}</a>
                    <small>{{order.createdAt | date:'MM-dd HH:mm:ss'}}</small><br/>
                    <input type="checkbox" name="exportOrderIdList[]" value="{{order._id}}" ng-checked="data.exportOrderIdList.indexOf(order._id) > -1" ng-click="toggleOrderSelection(order._id)" id="check{{order.orderNumber}}">
                    <label for="check{{order.orderNumber}}" style="font-size:10px">{{order.orderNumber}}</label>
                </td>
                <td>
                    <span ng-if="order.status === 'not paid'">未支付</span>
                    <span ng-if="order.status === 'paid'">已支付</span>
                    <span ng-if="order.status === 'confirmed'">已确认</span>
                    <span ng-if="order.status === 'dish finished'">菜品已制作完成</span>
                    <span ng-if="order.status === 'packaged'">已打包</span>
                    <span ng-if="order.status === 'shipped'">已发货</span>
                    <span ng-if="order.status === 'finished'">已完成</span>
                    <span ng-if="order.status === 'canceled'">已取消</span>
                </td>
                <td>
                    <span ng-if="order.expressStatus==='waitForConfirm'">待抢单</span>
                    <span ng-if="order.expressStatus==='waitForPick'">待取件</span>
                    <span ng-if="order.expressStatus==='shipping'">送货中</span>
                    <span ng-if="order.expressStatus==='finished'">已送达</span>
                    <span ng-if="order.expressStatus==='canceled'">已取消</span>

                    <br/>{{order.expressPersonName}} <a ui-sref="menu.updateUser({ id: order.expressPersonId })"> {{order.expressPersonMobile}}</a>

                </td>

                <!--<td>{{order.isSplitOrder}}</td>暂时隐藏掉,S要求-->
                <!--<td>{{order.isChildOrder}}</td>-->
                <td>
                    <span ng-if="order.clientFrom === 'ios'">iOS</span>
                    <span ng-if="order.clientFrom === 'android'">Android</span>
                    <span ng-if="order.clientFrom === 'wechat'">微信</span>
                    <span ng-if="order.clientFrom === 'website'">PC版网站</span>
                    <span ng-if="order.clientFrom === 'mobileweb'">移动版网站</span>
                </td>

                <td><a href="/api/administrator/shiplist/{{order._id}}" target="_blank"> {{order.address.contactPerson}}</a><br/>{{order.address.mobile}}</td>
                <td>
                    <a ui-sref="menu.updateUser({ id: order.user })" target="_blank">
                    {{order.address.city}} {{order.address.district}}<br/>
                    {{order.address.street}} / {{order.address.address}}</a>
                    <a target="_blank" href="http://api.map.baidu.com/direction?origin=latlng:31.195693,121.467155|name:新味&amp;destination={{order.address.street}}{{order.address.address}}&amp;mode=driving&amp;origin_region=上海&amp;output=html&amp;src=新味|定位&amp;destination_region={{order.address.city}}"><i class="fa fa-search-plus"></i>{{order.address.distanceFrom}}米</a>
                </td>

                <td>{{order.userComment}}</td>
                <td>{{order.csComment}}</td>

                <td>
                    <span ng-if="order.payment === 'alipay direct'">支付宝</span>
                    <span ng-if="order.payment === 'weixinpay'">微信支付</span>
                    <span ng-if="order.payment === 'account balance'">新味币</span>
                </td>
                <td>{{order.isPaymentPaid ? '是' : '否'}}</td>
                <!--<td>{{order.paymentUsedCash}}</td>-->
                <td>{{order.deliveryDateTime | date:'MM-dd HH:mm'}}</td>
                <td>{{order.cookingType == 'ready to cook' ? '食材包' : '便当'}}</td>
                <td>{{order.dishesPrice}}</td>
                <!--<td>{{order.credit}}</td>-->

                <td>{{order.promotionDiscount? ( -order.promotionDiscount ):''}} <br/> {{order.promotionCode ? ( order.promotionCode ):''}} / <a ui-sref="menu.updateCoupon({ id: order.coupon })">{{order.couponDiscount ? ( -order.couponDiscount ):''}}</a></td>

                <td>{{order.accountUsedDiscount}} </td>
                <td>{{order.freight}}</td>
                <td>{{order.totalPrice}}</td>

                <!--<td>-->
                    <!--<div class="alert alert-danger" role="alert" ng-show="data.currentDeleteIndex===order._id">确认真的删除吗？-->
                        <!--<button class="btn btn-danger" ng-click="delOrder(order)">立即删除</button>-->
                        <!--<button class="btn btn-info" ng-click="data.currentDeleteIndex=-1">返回</button>-->
                    <!--</div>-->
                    <!--<button class="btn btn-danger" ng-show="data.currentDeleteIndex!==order._id" ng-click="data.currentDeleteIndex=order._id">删除</button>-->
                <!--</td>-->
            </tr>
        </tbody>
    </table>





    <table class="table table-striped table-bordered table-hover table-responsive" ng-if="css.showTable === 'statisticByAddress'">
        <thead>
        <tr>
            <th>订单地址</th>

            <th>订单数量</th>
            <th>订单总金额</th>
            <th>订单客单价</th>

            <th>菜品总金额</th>
            <th>菜品客单价</th>
            <th>运费总金额</th>
            <th>运费平均金额</th>

            <th>优惠码总金额 / 平均</th>
            <th>优惠券总金额 / 平均</th>
            <th>新味币总金额 / 平均</th>

            <th>订单详细列表</th>

        </tr>
        </thead>
        <tbody>
        <tr ng-repeat="order in data.orderStatisticByAddressList ">
            <!--<td><a ui-sref="menu.updateOrder({ id: order._id })">{{order.orderNumber}}</a> <br/> {{order.createdAt | date:'yyyy-MM-dd HH:mm:ss Z'}}</td>-->
            <td>{{order._id}}</td>

            <td>{{order.saleQuantity}}</td>
            <td>{{order.saleTotalPrice | number : 2}} / {{order.totalPricePercent * 100 | number : 2}}%</td>
            <td>{{order.saleAvgTotalPrice | number : 2}}</td>

            <td>{{order.saleDishesPrice | number : 2}}</td>
            <td>{{order.saleAvgDishesPrice | number : 2}}</td>
            <td>{{order.saleFreight | number : 2}}</td>
            <td>{{order.saleAvgFreight | number : 2}} </td>

            <td>{{-order.salePromotionDiscount | number : 2}} ／ {{-order.saleAvgPromotionDiscount | number : 2}}</td>
            <td>{{-order.saleCouponDiscount | number : 2}} ／ {{-order.saleAvgCouponDiscount | number : 2}}</td>
            <td>{{-order.saleAccountUsedDiscount | number : 2}} ／ {{-order.saleAvgAccountUsedDiscount | number : 2}}</td>

            <td> <button class="btn btn-info" ng-click="data.currentDailySalesIndex=order._id"> 显示详细</button> <br/>
                <span ng-if="data.currentDailySalesIndex === order._id">
                     <span ng-repeat="orderDetail in order.orderList"> <a ui-sref="menu.updateOrder({ id: orderDetail._id })">{{orderDetail.orderNumber}} </a> 订单总价:{{orderDetail.totalPrice}} <br/> </span>
                </span>
            </td>

        </tr>
        </tbody>
    </table>


    <div class="row" ng-if="css.showTable === 'statisticByAddressAuto'">
        <div class="col-lg-2">图标颜色占金额比重依次为: </div>
        <div class="col-lg-1"><img class="mapmarker" src="/admin/src/img/marker100.png" alt=""/> >2%</div>
        <div class="col-lg-1"><img class="mapmarker" src="/admin/src/img/marker80.png" alt=""/> >1.5%</div>
        <div class="col-lg-1"><img class="mapmarker" src="/admin/src/img/marker70.png" alt=""/> >1.1%</div>
        <div class="col-lg-1"><img class="mapmarker" src="/admin/src/img/marker60.png" alt=""/> >0.8%</div>
        <div class="col-lg-1"><img class="mapmarker" src="/admin/src/img/marker40.png" alt=""/> >0.6%</div>
        <div class="col-lg-1"><img class="mapmarker" src="/admin/src/img/marker30.png" alt=""/> >0.4%</div>
        <div class="col-lg-1"><img class="mapmarker" src="/admin/src/img/marker20.png" alt=""/> >0.2%</div>
    </div>
    <div id="baidumap" class="row baidumap" ng-if="css.showTable === 'statisticByAddressAuto'">

    </div>

    <table class="table table-striped table-bordered table-hover table-responsive" ng-if="css.showTable === 'statisticByAddressAuto'">
        <thead>
        <tr>
            <th>订单地址</th>

            <th>订单数量</th>
            <th>订单总金额 / 百分比</th>
            <th>订单客单价</th>

            <th>菜品总金额</th>
            <th>菜品客单价</th>
            <th>运费总金额</th>
            <th>运费平均金额</th>

            <th>优惠码总金额 / 平均</th>
            <th>优惠券总金额 / 平均</th>
            <th>新味币总金额 / 平均</th>

            <th>订单详细列表</th>

        </tr>
        </thead>
        <tbody>
        <tr ng-repeat="order in data.orderStatisticByAddressListAuto ">
            <!--<td><a ui-sref="menu.updateOrder({ id: order._id })">{{order.orderNumber}}</a> <br/> {{order.createdAt | date:'yyyy-MM-dd HH:mm:ss Z'}}</td>-->
            <td>{{order._id}}</td>

            <td>{{order.saleQuantity}}</td>
            <td>{{order.saleTotalPrice | number : 2}} / {{order.totalPricePercent * 100 | number : 2}}%</td>
            <td>{{order.saleAvgTotalPrice | number : 2}}</td>

            <td>{{order.saleDishesPrice | number : 2}}</td>
            <td>{{order.saleAvgDishesPrice | number : 2}}</td>
            <td>{{order.saleFreight | number : 2}}</td>
            <td>{{order.saleAvgFreight | number : 2}} </td>

            <td>{{-order.salePromotionDiscount | number : 2}} ／ {{-order.saleAvgPromotionDiscount | number : 2}}</td>
            <td>{{-order.saleCouponDiscount | number : 2}} ／ {{-order.saleAvgCouponDiscount | number : 2}}</td>
            <td>{{-order.saleAccountUsedDiscount | number : 2}} ／ {{-order.saleAvgAccountUsedDiscount | number : 2}}</td>

            <td> <button class="btn btn-info" ng-click="data.currentDailySalesIndex=order._id"> 显示详细</button> <br/>
                <span ng-if="data.currentDailySalesIndex === order._id">
                     <span ng-repeat="orderDetail in order.orderList"> <a ui-sref="menu.updateOrder({ id: orderDetail._id })">{{orderDetail.orderNumber}} </a> 订单总价:{{orderDetail.totalPrice}} <br/> </span>
                </span>
            </td>

        </tr>
        </tbody>
    </table>





    <div class="row" ng-if="css.showTable === 'statisticByDailySales'">
        <div class="col-lg-12">
            <highchart id="chartDaily" config="chartDaily"  ></highchart>
        </div>


        <div class="col-lg-12">
            <label class="radio-inline" >
                <input type="radio" name="chartType"  ng-value="'column'" ng-model="chartDaily.series[0].type">柱状图
            </label>
            <label class="radio-inline" >
                <input type="radio" name="chartType"  ng-value="'line'" ng-model="chartDaily.series[0].type">折线图
            </label>
        </div>

        <div class="col-lg-12">
            <label for="prettyJSON">
                <input id="prettyJSON" type="checkbox" ng-model="prettyJSON"> Pretty JSON
            </label>
        </div>

        <div class="col-lg-12">
            <pre ng-show="prettyJSON">{{ chartDaily | json }}</pre>
            <pre ng-show="!prettyJSON">{{ chartDaily }}</pre>
        </div>

    </div>

    <table class="table table-striped table-bordered table-hover table-responsive" ng-if="css.showTable === 'statisticByDailySales'">
        <thead>
        <tr>
            <th>日期</th>
            <th>订单数量</th>
            <th>订单总金额</th>
            <th>订单客单价</th>

            <th>菜品总金额</th>
            <th>菜品客单价</th>
            <th>运费总金额</th>
            <th>运费平均金额</th>

            <th>优惠码总金额 / 平均</th>
            <th>优惠券总金额 / 平均</th>
            <th>新味币总金额 / 平均</th>

            <th>订单详细列表</th>

        </tr>
        </thead>
        <tbody>
        <tr ng-repeat="order in data.orderStatisticByDailySalesList | orderBy:css.searchOrderStatisticSortBy">
            <!--<td><a ui-sref="menu.updateOrder({ id: order._id })">{{order.orderNumber}}</a> <br/> {{order.createdAt | date:'yyyy-MM-dd HH:mm:ss Z'}}</td>-->
            <td>{{order.date | date:'yyyy-MM-dd'}}</td>

            <td>{{order.saleQuantity}}</td>
            <td>{{order.saleTotalPrice | number : 2}}</td>
            <td>{{order.saleAvgTotalPrice | number : 2}}</td>

            <td>{{order.saleDishesPrice | number : 2}}</td>
            <td>{{order.saleAvgDishesPrice | number : 2}}</td>

            <td>{{order.saleFreight | number : 2}}</td>
            <td>{{order.saleAvgFreight | number : 2}} </td>

            <td>{{-order.salePromotionDiscount | number : 2}} ／ {{-order.saleAvgPromotionDiscount | number : 2}}</td>
            <td>{{-order.saleCouponDiscount | number : 2}} ／ {{-order.saleAvgCouponDiscount | number : 2}}</td>
            <td>{{-order.saleAccountUsedDiscount | number : 2}} ／ {{-order.saleAvgAccountUsedDiscount | number : 2}}</td>

            <td><button class="btn btn-info" ng-click="data.currentDailySalesIndex=order.date"> 显示详细</button> <br/>
                <span ng-if="data.currentDailySalesIndex === order.date">
                    <span ng-repeat="orderDetail in order.orderList"> <a ui-sref="menu.updateOrder({ id: orderDetail._id })">{{orderDetail.orderNumber}} </a> 订单总价:{{orderDetail.totalPrice}} <br/>  </span>
                </span>

            </td>

        </tr>
        </tbody>
    </table>



    <div class="row" ng-if="css.showTable === 'statisticByHourSales'">
        <div class="col-lg-12">
            <highchart id="chartHour" config="chartHour"  ></highchart>
        </div>


        <div class="col-lg-12">
            <label class="radio-inline" >
                <input type="radio" name="chartType"  ng-value="'column'" ng-model="chartHour.series[0].type">柱状图
            </label>
            <label class="radio-inline" >
                <input type="radio" name="chartType"  ng-value="'line'" ng-model="chartHour.series[0].type">折线图
            </label>
        </div>

        <div class="col-lg-12">
            <label for="prettyJSON">
                <input id="prettyJSON2" type="checkbox" ng-model="prettyJSON"> Pretty JSON
            </label>
        </div>

        <div class="col-lg-12">
            <pre ng-show="prettyJSON">{{ chartHour | json }}</pre>
            <pre ng-show="!prettyJSON">{{ chartHour }}</pre>
        </div>

    </div>

    <table class="table table-striped table-bordered table-hover table-responsive" ng-if="css.showTable === 'statisticByHourSales'">
        <thead>
        <tr>
            <th>小时</th>
            <th>订单数量</th>
            <th>订单总金额</th>
            <th>订单客单价</th>

            <th>菜品总金额</th>
            <th>菜品客单价</th>
            <th>运费总金额</th>
            <th>运费平均金额</th>

            <th>优惠码总金额 / 平均</th>
            <th>优惠券总金额 / 平均</th>
            <th>新味币总金额 / 平均</th>

            <th>订单详细列表</th>

        </tr>
        </thead>
        <tbody>
        <tr ng-repeat="order in data.orderStatisticByHourSalesList ">
            <!--<td><a ui-sref="menu.updateOrder({ id: order._id })">{{order.orderNumber}}</a> <br/> {{order.createdAt | date:'yyyy-MM-dd HH:mm:ss Z'}}</td>-->
            <td>{{ order.hour < 16 ? (order.hour + 8 ):(order.hour - 16 ) }}</td>

            <td>{{order.saleQuantity}}</td>
            <td>{{order.saleTotalPrice | number : 2}}</td>
            <td>{{order.saleAvgTotalPrice | number : 2}}</td>

            <td>{{order.saleDishesPrice | number : 2}}</td>
            <td>{{order.saleAvgDishesPrice | number : 2}}</td>

            <td>{{order.saleFreight | number : 2}}</td>
            <td>{{order.saleAvgFreight | number : 2}} </td>

            <td>{{-order.salePromotionDiscount | number : 2}} ／ {{-order.saleAvgPromotionDiscount | number : 2}}</td>
            <td>{{-order.saleCouponDiscount | number : 2}} ／ {{-order.saleAvgCouponDiscount | number : 2}}</td>
            <td>{{-order.saleAccountUsedDiscount | number : 2}} ／ {{-order.saleAvgAccountUsedDiscount | number : 2}}</td>

            <td><button class="btn btn-info" ng-click="data.currentDailySalesIndex=order.hour"> 显示详细</button> <br/>
                <span ng-if="data.currentDailySalesIndex === order.hour">
                    <span ng-repeat="orderDetail in order.orderList"> <a ui-sref="menu.updateOrder({ id: orderDetail._id })">{{orderDetail.orderNumber}} </a> 订单总价:{{orderDetail.totalPrice}} <br/>  </span>
                </span>

            </td>

        </tr>
        </tbody>
    </table>







</div>
